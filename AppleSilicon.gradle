// AUTHOR  : LukeGrahamLandry#6888
// LICENSE : MIT
// README  : https://moddingtutorials.org/o19/m1
// NOTE    : you MUST set mc_version in your gradle.properties file

import java.nio.charset.StandardCharsets
import java.nio.file.Files

logger.error(System.getProperty("os.arch"))
logger.error(System.getProperty("os.name"))
if (System.getProperty("os.arch").equals("aarch64") && System.getProperty("os.name").equals("Mac OS X")){
    project.ext.lwjglVersion = "2.9.4-nightly-20150209"
    project.ext.lwjglNatives = "natives-osx"

    configurations.all {
        resolutionStrategy {
            force "org.lwjgl:lwjgl:${lwjglVersion}"
            force "org.lwjgl:lwjgl-openal:${lwjglVersion}"
            force "org.lwjgl:lwjgl-opengl:${lwjglVersion}"
            force "org.lwjgl:lwjgl-jemalloc:${lwjglVersion}"
            force "org.lwjgl:lwjgl-glfw:${lwjglVersion}"
            force "org.lwjgl:lwjgl-stb:${lwjglVersion}"
            force "org.lwjgl:lwjgl-tinyfd:${lwjglVersion}"
        }
    }

    logger.error("Apple Silicon for MC version ${project.mc_version}")

    //String path = "caches/modules-2/files-2.1/org.lwjgl.lwjgl/lwjgl/2.9.1/8de39a6a41f6cf4517439928b7087b6e9f769f44/lwjgl-2.9.1.pom"
    //File cache = new File(project.getGradle().getGradleUserHomeDir(), path)
	  //logger.error(cache.getAbsolutePath())
    //if (cache.exists()) {
    //    List<String> lines = Files.readAllLines(cache.toPath(), StandardCharsets.UTF_8);
    //
    //    FileWriter writer = new FileWriter(cache);
    //
    //    for (String line : lines){
    //        if (line.contains("version")) line = line.replaceAll("2.9.1", "2.9.4-nightly-20150209") + "\n"
    //        if (!line.contains("arm")) line = line.replaceAll("natives-macos", "natives-macos-arm64") + "\n"
    //       writer.append(line)
    //    }
    //    writer.close();
    //}
}
